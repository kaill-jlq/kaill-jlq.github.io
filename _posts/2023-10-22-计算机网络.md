---
title: ZJU 计算机网络
layout: post
tags: 计算机网络
description: 这里记录本人在学习计算机网络课程的笔记
---

## Overall



### 1.2 网络实例



#### 网络分类

+ 个域网PAN(Person Area Network)
    + 范围一般在10米半径以内，如蓝牙耳机
+ 局域网LAN（Local Area Network）
    + 局部地区形成的区域网络，如企业网络
    + 电脑WLAN接入，打印机等等
+ 城域网MAN（Metropolitan Area Network）
+ 广域网WAN（Wide Area Network）
    + 覆盖范围很大，乃至整个地区或国家



#### Internet 和 internet 区别

![Test Image2](/assets/images/internet.png)



#### 互联网构成

+ 网络边缘
    + 端系统：位于互联网边缘与互联网相连的计算机和其他设备
    + 端系统是互联网通信的**起点和终点**
    + 端系统由各类主机构成，包括个人计算机（如台式机和笔记本电脑）、智能手机、平板电脑、服务器和其他网络连接的设备
+ 网络核心
    + 由互联网系统的**分组交换设备**和**通信链路**构成的网状网络
    + 分组交换（ 路由器、链路层交换机）
    + 通信链路（光纤、铜缆 、无线电、 激光链路）


> 分组交换设备：在计算机网络中用于传输数据的网络设备。它将数据划分为较小的数据包（也称为分组），并根据目标地址将这些数据包从源设备传输到目标设备。常见的分组交换设备包括路由器和交换机。
>
> 路由器：用于在不同的网络之间转发数据包。它根据数据包的目标地址，使用路由表和路由选择算法确定最佳路径，并将数据包转发到下一个网络节点，直到到达目标设备。
>
> 交换机：交换机是一种分组交换设备，用于在局域网（LAN）内传输数据包。它根据数据包的目标MAC地址，将数据包从源设备转发到目标设备。交换机在局域网中提供高速、低延迟的数据传输，支持多个设备之间的并行通信。



#### 接入网

接入网（Access Network）是指将终端用户连接到互联网或其他广域网络的网络部分。

+ 接入网目标：将主机连接到边缘路由器上。
+ **边缘路由器**是端系统 `Host `去往任何其他远程端系统的路径上的第一台路由器



#### 物理介质

+ 传输单元：bit
  + bit是在发射机和接收机之间的物理介质上传播的数据的最小单元
+ 物理媒体：即发射机与接收机之前的具体的链路介质
  - 引导型介质：信号在固体介质中传播，例如铜、光纤、同轴电缆
  - 非引导型介质：信号自由传播，例如无线电（陆地无线电、卫星无线 电信道 )

> **存储**常用字节 Byte 
>
> K/M/G 层级为 2^10 进制 
>
> 传输常用比特 Bit 
>
> K/M/G 层级为 10^3 进制
>
> **1B = 8b**



#### 网络核心

- 目标：将海量的端系统互联起来
- 由各类交换机（路由器）和链路构成的网状网络

**`两大功能`**

功能 1 ：`路由（Routing）`

- **全局操作**：确定数据分组从源到目标所使用的路径
- 需要路由协议和路由算法，**产生路由表**

功能 2 ：`转发（Forwarding）`

- **本地操作**：路由器或交换机将接收到的数据分组转发出去（即移动到该设备的某个输出接口）
- 确定转发出去的接口 / 链路：根据从“入接口”收到分组头中的目的地址，查找本地**路由表**，确定“出接口”



#### 交换类型

+ 电路交换

  + 电路交换通常采用面向连接方式
  + 先呼叫建立连接，实现端到端的资源预留
  + 预留的资源包括：链路带宽资源、交换机的交换能力
  + 电路交换连接建立后，物理通路被通信双方独占，**资源专用**，即使空闲也不与其他连接共享，通信路径在通话期间一直保持稳定，为通信双方提供**专用的、连续的**通信通道。
  + 由于建立连接并预留资源，因此传输性能好；但如果传输中发生设备故障，则传输被中断

  > 在电路交换中，每个通话需要独占一条物理通路，但通信网络中的物理资源是有限的。为了更有效地利用这些资源，**多路复用技术**被引入，允许多个通话共享同一条物理通路。
  >
  > 1. 频分多路复用（Frequency Division Multiplexing，FDM）：在频分多路复用中，物理通路的频谱被划分为不同的频带，每个频带用于传输一个通话的数据。每个通话使用不同的频带进行数据传输，因此多个通话可以同时在不同的频带上进行传输，共享同一条物理通路。
  > 2. 时分多路复用（Time Division Multiplexing，TDM）：在时分多路复用中，物理通路的时间被划分为若干个时隙（time slot），每个时隙用于传输一个通话的数据。多个通话按照预定的顺序轮流使用时隙，每个通话只在分配给它的时隙中传输数据。这样，通过时间的划分，多个通话可以共享同一条物理通路。

+ 存储转发的报文交换（Store-and-Forward Packet Switching）

  - 存储&转发 - 路由器需要接收到完整的整个数据报文后，才能开始向下一跳发送

  - 存储转发带来报文的传输延迟
    - 将L位数据报文，以R bps的速率，发送到链路中： 需要L/R秒

+ 分组交换（packet switching）

  + 将大报文拆分成多个小分组
  + 通信双方以分组为单位、使用存储转发机制，实现数据交互的通信方式
  + 以分组作为数据传输单元，**每个分组的首部都含有地址**（目的地址和源地址）等控制信息
  + 每个分组在互联网中独立地选择传输路径
  + 支持灵活的统计多路复用

​	分组交换适合有大量`突发数据（burst）`传输需求的网络

> 三种交换方式的比较：
>
> 1. 电路交换需要建立连接并预留资源，难以实现灵活复用
> 2. 报文交换和分组交换较灵活，抗毁性高，在传送突发数据时可提高网络利用率
> 3. 由于分组长度小于报文长度，分组交换比报文交换的时延小，也具有更好的灵活性，但附加信息开销更大



### 1.3 协议与分层结构

**网络协议**

- 为进行网络中的数据交换而建立的规则、标准或约定，即网络协议 (network protocol)
- 通信双方需要共同遵守，互相理解

**三要素**

- 语法：规定传输数据的格式（如何讲）
- 语义：规定所要完成的功能（讲什么）
- 时序：规定各种操作的顺序（双方讲话的顺序）

**协议分层结构**的必要性：

+ 分层结构：明晰简化，便于分析学习
+ 模块独立：各层独立，加速技术演进
+ 统一标准：确保技术互通



**协议分层结构**

- 层次栈（ Protocol stack ） - 为降低网络设计的复杂性，网络使用层次结构的协议栈，每一层都使用其下一层所提供的服务，并为上层提供自己的服务
- 对等实体 (Peer) - 不同机器上构成相应层次的实体成为对等实体
- 接口 (Interface) - 在每一对相邻层次之间的是接口，其定义了**下层向上层提供哪些服务原语**
- 网络体系结构 (Network infrastructure) - 层和协议的集合为网络体系结构，一个特定的系统所使用的一组协议，即每层的协议，称为协议栈

![Test Image2](/assets/images/level.jpeg)

发送端层层封装，接收段层层解封

![Test Image2](/assets/images/level2.jpeg)



**服务**

- 典型服务：面向连接传输服务，无连接传输服务
- 服务由一组可用于用户进程以访问服务的原语（操作）形式指定
- 原语告诉服务执行某些操作或报告对等实体所采取的操作



**两种不同类型的服务：**

- **面向连接** - 类似于同步机制，需要双方建立连接，每个“请求”或“响应”后，都在对方产生一个“指示”或“确认”动作
- 无连接 - 类似于异步机制，传输过程**不需要应答**

![Test Image2](/assets/images/1.jpeg)



**服务与协议的关系**

- 协议是“水平”的，服务是“垂直”的
- 实体使用协议来实现其定义的服务
- 上层实体通过接口使用下层实体的服务



### 1.4 参考模型

![Test Image2](/assets/images/compare.png)

一些名称：

- 比特流（bit）：物理层/一层。
- 数据帧（frame）：数据链路层/二层。
- 数据包/报文分组（packet）：网络层/三层。
- 数据报（datagram）：传输层 UDP/四层。
- 数据段（segment）：传输层 TCP/四层。
- 消息/报文（message）：三层以上，通常指应用层/七层。



### 1.5 计算机网络度量单位



+ **比特率**（bit rate）
  + 主机在数字信道上传送数据的速率，也称数据率
  + 比特率的单位为b/s，也称bps，或kbit/s,Mbit/s,Gbit/s等
+ **带宽**：网络中某通道传送数据的能力，即**单位时间**内网络中的某信道所能通过的“**最高数据率**”
  - 单位是 bit/s
+ **包转发率 (PPS) -** 全称是 Packet Per Second，表示交换机或路由器等网络设备以包为单位的转发速率
  - 线速转发：交换机端口在满负载的情况下，对帧进行转发时能够达到该端口线路的最高速度
+ **时延 (delay & latency) -** 是指数据（一个报文或分组）从网络（或链路）的**一端传送到另一端所需的时间**，也称为延迟，包括：
  - **传输时延 (transmission delay) -** 数据从结点进入到传输媒体所需要的时间，传输时延又称为**发送时延**
  - **传播时延 (propagation delay) -** 电磁波在信道中需要传播一定距离而花费的时间
  - **处理时延 (processing delay)** - **主机或路由器**在收到分组时，为处理分组（例如分析首部、提取数据、差错检验或查找路由）各层协议的基本工作原理及所花费的时间
  - **排队时延 (queueing delay)** - 分组在路由器输入输出队列中排队等待处理所经历的时延

$$
d_{trans} = \frac{Length(bit)}{R(bit/s)} //transmission \_ delay
$$

$$
d_{prop} = \frac{Distance(m)}{c(m/s)}// propagation\_delay
$$



+ **往返时延 RTT(Round-Trip Time)** - 从发送方发送数据开始，到发送方收到来自接收方的确认，经历的`总时间`
  - 可用于判断网络的通断性、测试网络时延、计算数据包丢失率等(`ping命令`)
+ **时延带宽积（Delay-Bandwidth Product） = 传播时延 \* 带宽，**即按**比特计数**的链路长度
  - 若发送端连续发送数据，则在发送的第一个 bit 即将达到终点时，发送端就已经发送了**时延带宽积**个 bit ，而这些 bit 都在链路上向前移动，较大的时延带宽积意味着在网络中有更多的比特数等待传输或处理。

![Test Image2](/assets/images/shiyan.jpeg)



+ **吞吐量（throughout）**
  + 单位时间内通过某个网络（或信口、接口）的数据量，单位是b/s
+ **有效吞吐量 (goodput) **
  + 单位时间内，目的地正确接收到的有用信息的数目（以 bit 为单位）
+ **利用率**
  - 信道利用率指出某信道有百分之几的时间是被利用的
  - 网络利用率则是全网络的信道利用率的加权平均值
+ **时延抖动 -** 变化的时延称为抖动（Jitter）
  - 时延抖动起源于网络中的队列或缓冲，抖动难以精确预测
  - 在语音、视频多媒体业务中，抖动往往会严重影响用户的体验

+ **延迟丢包** 
  +  在多媒体应用中，由于数据包延迟到达，在接收端需要丢弃失去使用价值的包



## Physical Level



### 物理层基本概念



#### 物理层功能

**位置：**物理层是网络体系结构中的最低层

**功能：**如何在连接各计算机的传输媒体上**传输数据比特流**

**作用**：尽可能地**屏蔽掉不同传输媒体和通信手段的差异**

+ 为数据链路层提供一个统一的数据传输服务

**点对点通信线路** - 用于直接连接两个结点 (RS-232-C标准, RS-449标准)

**广播通信线路** - 一条公共通信线路连接多个结点 (802.3)



### 数据通信基础

+ 时域观
  + 模拟信号：信号强度随时间平滑变化，中间无突变或不连续地方
  + 数字信号：在一段时间保持恒定，然后又变为另一个恒定值
+ 频域观
  + 当一个信号所有频率成分是某一个频率的整数倍，该频率被称为**基本频率**
  + 信号的周期等于基本频率的周期

#### 有限带宽信号

+ 频谱` spectrum `是一个信号所包含的频率的范围，信号的绝对带宽等于频谱的宽度
  + 许多信号的带宽是无限的，然而信号的主要能量集中在相对窄的频带内，**这个频带被称为有效带宽，或带宽`bandwidth`**
  + 带宽越宽，信号的信息承载能力越强

+ 信号在信道上传输时的特性

  - 对不同傅立叶分量的衰减不同，引起输出失真

  - 信道有截止频率`fc` ， `0 ~ fc` 的振幅衰减较弱， `fc` 以上的振幅衰减厉害，这主要由信道的物理特性决定， **`0 ~ fc` 是信道的有限带宽**

  - 实际使用时，可以接入滤波器，限制用户的带宽

  - 通过信道的谐波次数越多，信号越逼真

![Test Image2](/assets/images/limit.jpeg)
